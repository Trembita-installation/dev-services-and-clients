
### **Post Person**
Створюється один запис з БД про певну особу.

|  Метод HTTP | Код сервісу  | Базова URL                        |
|:-------:|:-------------:|-----------------------------------|
|  POST   |   Post Person     | http://your-server-ip:8080/api/v1/persons/add |

Параметри запиту виглядають наступним чином:

```
{
  "firstName": "Марина",
  "lastName": "Петренко",
  "patronymic": "Петрівна",
  "birthDate": "2014-10-11",
  "pasport": "АА123456",
  "gender": "female",
  "unzr": "20141011-12345",
  "rnokpp": "1234567890"
}
```
де:

| Рівень <br/> вкладеності | Назва <br/>параметру | Тип даних                       | Значення параметру                                                                                                                        | Обов’язковість |
|:------------------------:|----------------------|---------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------|:--------------:|
|            1             | 	firstName         |String, <br/>min=1, <br/>max=128 | 	Ім’я                                                                                                                                     |      	Так      |
|            1             | 	lastName          |String, <br/>min=1, <br/>max=128 | 	Прізвище                                                                                                                                 |      	Так      |
|            1             | 	patronymic        |String, <br/>min=0,<br/> max=128 | 	По батькові                                                                                                                              |      	Ні       |
|            1             | 	birthDate         |String                           | 	Дата народження                                                                                                                          |      	Так      |
|            1             | 	pasport           |String                           | 	Номер паспорта.<br/> **Для старого формату** – перші 2 символи - літери від А до Я, 6 цифр.<br/> **Для нового формату** – 9 цифр |      	Так      |
|            1             | 	gender            |String                           | 	Стать                                                                                                                            |      	Так      |
|            1             | 	unzr              |String                           | 	УНЗР, 14 символів в форматі YYYYMMDD-XXXXC, де  YYYY – рік, MM – місяць, DD – день,  XXXXC – 5 цифр                                      |      Так       |
|            1             | 	rnokpp            |String                           | 	РНОКПП, 10 цифр                                                                                                                          |      	Так      |

**Приклад запиту** за допомогою утиліти **curl** виглядає наступним чином:

```
curl -X 'POST' \
  'http://your-server-ip:8080/api/v1/persons/add' \
  -H 'accept: */*' \
  -H 'Content-Type: application/json' \
  -d "{\"firstName\": \"Марина\", \"lastName\": \"Петренко\", \"patronymic\": \"Петрівна\", \"birthDate\": \"2014-10-11\", \"pasport\": \"АА123456\", \"unzr\": \"20141011-12345\", \"rnokpp\": \"1234567890\"}"
```

**Тіло відповіді** у разі успішного опрацювання запиту (**HTTP Code=200**) виглядатиме наступним чином:

```
{
    "status": true,
    "descr": "Successful request",
    "result": "{\"firstName\":\"Марина\",\"lastName\":\"Петренко\",\"patronymic\":\"Петрівна\",\"rnokpp\":\"1234567891\",\"CheckedRequest\":\"0001-01-01T00:00\",\"unzr\":\"20141011-12345\",\"pasport\":\"741852963\",\"id\":109,\"birthDate\":\"2014-10-11\",\"isChecked\":false,\"age\":11}"
}
```

де:

| Рівень <br/> вкладеності | Назва <br/>параметру | Тип даних   | Значення параметру       | Обов’язковість |
|:------------------------:|----------------------|-------------|--------------------------|:--------------:|
|            1             | status               | Boolean     | Статус запиту            |      Так       |
|            1             | descr                | String      | Відповідь сервісу        |      Так       |
|            1             | result               | String      | Результат обробки запиту |      Так       |

**Тіло відповіді** у разі не успішного опрацювання запиту (**HTTP Code=200**) виглядатиме наступним чином:

```
{
    "status": false,
    "descr": "could not execute statement [ERROR: duplicate key value violates unique constraint \"uk7x0f32nudq9bf6tbp86oh8vyk\"\n  Detail: Key (rnokpp)=(1234567891) already exists.] [insert into persona (checked_request,birth_date,first_name,is_checked,last_name,pasport,patronymic,rnokpp,unzr,id) values (?,?,?,?,?,?,?,?,?,?)]; SQL [insert into persona (checked_request,birth_date,first_name,is_checked,last_name,pasport,patronymic,rnokpp,unzr,id) values (?,?,?,?,?,?,?,?,?,?)]; constraint [uk7x0f32nudq9bf6tbp86oh8vyk]",
    "result": null
}
```

де:

| Рівень <br/> вкладеності | Назва <br/>параметру | Тип даних   | Значення параметру       | Обов’язковість |
|:------------------------:|----------------------|-------------|--------------------------|:--------------:|
|            1             | status               | Boolean     | Статус запиту            |      Так       |
|            1             | descr                | String      | Відповідь сервісу        |      Так       |
|            1             | result               | String      | Результат обробки запиту |      Так       |

### **Get Person List**

Повертає всі записи з БД.

| Метод HTTP |  Код сервісу   | Базова URL                                      |
|:----------:|:--------------:|-------------------------------------------------|
|    GET     | Get Person List | http://your-server-ip:8080/api/v1/persons/list |

```
curl -X 'GET' \
  http://your-server-ip:8080/api/v1/persons/list' \
 -H 'accept: */*'
  ```

**Тіло відповіді** у разі успішного опрацювання запиту (**HTTP Code=200**) виглядатиме наступним чином:

```
{
    "status": true,
    "descr": "Successful request",
    "result": "[{\"firstName\":\"Юстина\",\"lastName\":\"Василашко\",\"patronymic\":\"Станіславівна\",\"rnokpp\":\"8976620095\",\"CheckedRequest\":\"0001-01-01T00:00\",\"unzr\":\"19780816-46182\",\"pasport\":\"PE189302\",\"id\":1,\"birthDate\":\"1978-08-16\",\"isChecked\":false,\"age\":47},{\"firstName\":\"Пріска\",\"lastName\":\"Ященко\",\"patronymic\":\"Петрівна\",\"rnokpp\":\"6607920612\",\"CheckedRequest\":\"0001-01-01T00:00\",\"unzr\":\"19600726-15596\",\"pasport\":\"HH150599\",\"id\":2,\"birthDate\":\"1960-07-26\",\"isChecked\":false,\"age\":65},{\"firstName\":\"Пилип\",\"lastName\":\"Влох\",\"patronymic\":\"Ростиславович\",\"rnokpp\":\"6555888936\",\"CheckedRequest\":\"0001-01-01T00:00\",\"unzr\":\"19770531-64914\",\"pasport\":\"HM429278\"]"
}
```

де:

| Рівень <br/> вкладеності | Назва <br/>параметру | Тип даних   | Значення параметру       | Обов’язковість |
|:------------------------:|----------------------|-------------|--------------------------|:--------------:|
|            1             | status               | Boolean     | Статус запиту            |      Так       |
|            1             | descr                | String      | Відповідь сервісу        |      Так       |
|            1             | result               | String      | Результат обробки запиту |      Так       |


### **Update Person**
Вносить зміни для певного запису з БД про певну особу.

| Метод HTTP |  Код сервісу  | Базова URL                        |
|:----------:|:-------------:|-----------------------------------|
|    PATCH     | Update Person | http://your-server-ip:8080/api/v1/persons/update |


Параметри запиту виглядають наступним чином:

```
{
  "firstName": "Мари",
  "lastName": "Петренко",
  "patronymic": "Петрівна",
  "birthDate": "2014-10-11",
  "pasport": "АА123456",
  "gender": "female",
  "unzr": "20141011-12345",
  "rnokpp": "1234567890"
}
```
де:

| Рівень <br/> вкладеності | Назва <br/>параметру | Тип даних                        | Значення параметру                                                                                                                        | Обов’язковість |
|:------------------------:|----------------------|----------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------|:--------------:|
|            1             | 	firstName         | String, <br/>min=1, <br/>max=128 | 	Ім’я                                                                                                                                     |   	Так       |
|            1             | 	lastName          | String, <br/>min=1, <br/>max=128 | 	Прізвище                                                                                                                                 |     	Так       |
|            1             | 	patronymic        | String, <br/>min=0,<br/> max=128 | 	По батькові                                                                                                                              |     	Ні        |
|            1             | 	birthDate         | String                           | 	Дата народження                                                                                                                          |     	Так       |
|            1             | 	pasport           | String                           | 	Номер паспорта.<br/> **Для старого формату** – перші 2 символи - літери від А до Я, 6 цифр.<br/> **Для нового формату** – 9 цифр         |     	Так       |
|            1             | 	gender            | String                           | 	Стать                                                                                                                                    |     	Так       |
|            1             | 	unzr              | String                           | 	УНЗР, 14 символів в форматі YYYYMMDD-XXXXC, де  YYYY – рік, MM – місяць, DD – день,  XXXXC – 5 цифр                                      |      Так       |
|            1             | 	rnokpp            | String                           | 	РНОКПП, 10 цифр                                                                                                                          |     	Так       |

**Важливо!** Обмеження сервісу – не можна міняти поле **rnokpp**!

**Приклад запиту** за допомогою утиліти **curl** виглядає наступним чином:

```
curl -X 'PATCH' \
  'http://your-server-ip:8080/api/v1/persons/add' \
  -H 'accept: */*' \
  -H 'Content-Type: application/json' \
  -d "{\"firstName\": \"Мари\", \"lastName\": \"Петренко\", \"patronymic\": \"Петрівна\", \"birthDate\": \"2014-10-11\", \"pasport\": \"АА123456\", \"unzr\": \"20141011-12345\", \"rnokpp\": \"1234567890\"}"
```

**Тіло відповіді** у разі успішного опрацювання запиту (**HTTP Code=200**) виглядатиме наступним чином:

```
{
  "status": true,
  "descr": "Persona with RNOKPP 1234567890 updated successfully",
  "result": "{\"firstName\":\"Мари\",\"lastName\":\"Петренко\",\"patronymic\":\"Петрівна\",\"rnokpp\":\"1234567890\",\"gender\":\"female\",\"CheckedRequest\":\"0001-01-01T00:00\",\"unzr\":\"20141011-12345\",\"pasport\":\"АА123456\",\"id\":35,\"birthDate\":\"2014-10-11\",\"isChecked\":false,\"age\":11}"
}
```

де:

| Рівень <br/> вкладеності | Назва <br/>параметру | Тип даних   | Значення параметру       | Обов’язковість |
|:------------------------:|----------------------|-------------|--------------------------|:--------------:|
|            1             | status               | Boolean     | Статус запиту            |      Так       |
|            1             | descr                | String      | Відповідь сервісу        |      Так       |
|            1             | result               | String      | Результат обробки запиту |      Так       |


**Тіло відповіді** у разі не успішного опрацювання запиту (**HTTP Code=200**) виглядатиме наступним чином:

```
{
  "status": false,
  "descr": "Error: Target must not be null",
  "result": null
}
```

де:

| Рівень <br/> вкладеності | Назва <br/>параметру | Тип даних   | Значення параметру       | Обов’язковість |
|:------------------------:|----------------------|-------------|--------------------------|:--------------:|
|            1             | status               | Boolean     | Статус запиту            |      Так       |
|            1             | descr                | String      | Відповідь сервісу        |      Так       |
|            1             | result               | String      | Результат обробки запиту |      Так       |



### **Get Person By Parameter**

Повертає записи з БД відповідно до заданих параметрів.

| Метод HTTP |       Код сервісу       | Базова URL                        |
|:----------:|:-----------------------:|-----------------------------------|
|    GET     | Get Person By Parameter | http://your-server-ip:8080/api/v1/persons/find/{parameter} |

**Параметри запиту**, що передаються в URL виглядають наступним чином:
```
	"param":"?",
	"value":"?"
```
де:

| **Назва параметру** | **Тип даних** | **Значення параметру**                                                                                                                                                                                                        | **Обов’язковість** |
|:-------------------:|:-------------:|:------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|:------------------:|
|        param        |    	String    | Вказується конкретний параметр, що стосується певного запису в БД, наприклад, ім’я, УНЗР тощо. <br/> Назва параметру має бути однією з наступних:  firstname, lastname, birthDate, passport, unzr, age. <br/> дял пошуку по РНОКПП параметр вказувати не потрібно |        	Так        |                                                                                                                                                   |                    |
|        value        |    String     | 	Значення вказаного параметру                                                                                                                                                                                                 |        	Так        |

**Приклад запиту** за допомогою утиліти **curl** виглядає наступним чином:
```
curl -X 'GET' \
  'http://http://your-server-ip:8080/api/v1/persons/find/1234567890' \
  -H 'accept: */*'
  ```
**Тіло відповіді** у разі успішного опрацювання запиту (**HTTP Code=200**) виглядатиме наступним чином:

```
{
  "status": true,
  "descr": "Successful request",
  "result": "{\"firstName\":\"Мари\",\"lastName\":\"Петренко\",\"patronymic\":\"Петрівна\",\"rnokpp\":\"1234567890\",\"gender\":\"female\",\"CheckedRequest\":\"0001-01-01T00:00\",\"unzr\":\"20141011-12345\",\"pasport\":\"АА123456\",\"id\":35,\"birthDate\":\"2014-10-11\",\"isChecked\":false,\"age\":11}"
}
```

де:

| Рівень <br/> вкладеності | Назва <br/>параметру | Тип даних   | Значення параметру       | Обов’язковість |
|:------------------------:|----------------------|-------------|--------------------------|:--------------:|
|            1             | status               | Boolean     | Статус запиту            |      Так       |
|            1             | descr                | String      | Відповідь сервісу        |      Так       |
|            1             | result               | String      | Результат обробки запиту |      Так       |

**Тіло відповіді** у разі не успішного опрацювання запиту (**HTTP Code=200**) виглядатиме наступним чином:

```
{
  "status": true,
  "descr": "Person with RNOKPP: 1234567891 not found in database",
  "result": null
}
```

де:

| Рівень <br/> вкладеності | Назва <br/>параметру | Тип даних   | Значення параметру       | Обов’язковість |
|:------------------------:|----------------------|-------------|--------------------------|:--------------:|
|            1             | status               | Boolean     | Статус запиту            |      Так       |
|            1             | descr                | String      | Відповідь сервісу        |      Так       |
|            1             | result               | String      | Результат обробки запиту |      Так       |


### **Person Delete**
Дозволяє видалити запис з БД тільки за РНОКПП.

| Метод HTTP |       Код сервісу       | Базова URL                        |
|:----------:|:-----------------------:|-----------------------------------|
|    DELETE     | Person Get By Parameter | http://your-server-ip:8080/api/v1/persons/delete |

**Параметри запиту**, що передаються в URL виглядають наступним чином:

```
	"value":"?"
```

де:

| **Назва параметру** | **Тип даних** |      **Значення параметру**      | **Обов’язковість** |
|:-------------------:|:-------------:|:--------------------------------:|:------------------:|
|        value        |    String     | 	РНОКПП запису який треба видалити |        	Так        |

**Приклад запиту** за допомогою утиліти **curl** виглядає наступним чином:
```
curl -X 'DELETE' 'http://your-server-ip:8080/api/v1/persons/delete/1234567890' \
  -H 'accept: */*'
```

**Тіло відповіді** у разі успішного опрацювання запиту (**HTTP Code=200**) виглядатиме наступним чином:
```
{
  "status": true,
  "descr": "Successful request",
  "result": "Persona with RNOKPP: 1234567890 was deleted!"
}
```
де:

| Рівень <br/> вкладеності | Назва <br/>параметру | Тип даних   | Значення параметру       | Обов’язковість |
|:------------------------:|----------------------|-------------|--------------------------|:--------------:|
|            1             | status               | Boolean     | Статус запиту            |      Так       |
|            1             | descr                | String      | Відповідь сервісу        |      Так       |
|            1             | result               | String      | Результат обробки запиту |      Так       |

**Тіло відповіді** у разі не успішного опрацювання запиту (**HTTP Code=200**) виглядатиме наступним чином:
```
{
  "status": true,
  "descr": "Person with RNOKPP: 1234567891 not found in database",
  "result": null
}
```
де:

| Рівень <br/> вкладеності | Назва <br/>параметру | Тип даних   | Значення параметру       | Обов’язковість |
|:------------------------:|----------------------|-------------|--------------------------|:--------------:|
|            1             | status               | Boolean     | Статус запиту            |      Так       |
|            1             | descr                | String      | Відповідь сервісу        |      Так       |
|            1             | result               | String      | Результат обробки запиту |      Так       |


### **Person Check**
Асинхронний режим роботи вебсервісу, перевірка обраного за РНОКПП запису на протязі 5 хвилин.

| Метод HTTP |       Код сервісу       | Базова URL                        |
|:----------:|:-----------------------:|-----------------------------------|
|    GET     | Person Get By Parameter | http://your-server-ip:8080/api/v1/persons/check |

**Параметри запиту**, що передаються в URL виглядають наступним чином:

```
	"value":"?"
```

де:

| **Назва параметру** | **Тип даних** |      **Значення параметру**       | **Обов’язковість** |
|:-------------------:|:-------------:|:---------------------------------:|:------------------:|
|        value        |    String     | РНОКПП запису який треба видалити |        Так         |

**Приклад запиту** за допомогою утиліти **curl** виглядає наступним чином:
```
curl -X 'DELETE' 'http://your-server-ip:8080/api/v1/persons/check/1234567892' \
  -H 'accept: */*'
```

**Тіло відповіді** у разі успішного опрацювання запиту (**HTTP Code=200**) виглядатиме наступним чином:

-відповідь на перший запит:
```
{
  "status": true,
  "descr": "Successful request",
  "result": "Request for checking Persona in progress!"
}
```

- відповідь на запит який надійшов в процесі обробки:

```
{
  "status": true,
  "descr": "Successful request",
  "result": "Checking Persona in progress!"
}
```
- відповідь на запит після закінчення обробки (обробка триває протягом 5хв):

```
{
  "status": true,
  "descr": "Successful request",
  "result": "Persona is checked!"
}
```

де:

| Рівень <br/> вкладеності | Назва <br/>параметру | Тип даних   | Значення параметру       | Обов’язковість |
|:------------------------:|----------------------|-------------|--------------------------|:--------------:|
|            1             | status               | Boolean     | Статус запиту            |      Так       |
|            1             | descr                | String      | Відповідь сервісу        |      Так       |
|            1             | result               | String      | Результат обробки запиту |      Так       |


**Тіло відповіді** у разі не успішного опрацювання запиту (**HTTP Code=200**) виглядатиме наступним чином:
```
{
  "status": true,
  "descr": "Person with RNOKPP: 1234567891 not found in database",
  "result": null
}
```
де:

| Рівень <br/> вкладеності | Назва <br/>параметру | Тип даних   | Значення параметру       | Обов’язковість |
|:------------------------:|----------------------|-------------|--------------------------|:--------------:|
|            1             | status               | Boolean     | Статус запиту            |      Так       |
|            1             | descr                | String      | Відповідь сервісу        |      Так       |
|            1             | result               | String      | Результат обробки запиту |      Так       |

### **Check Service Status**
Дозволяє перевірити працездатність сервісу.

| Метод HTTP |       Код сервісу       | Базова URL                                     |
|:----------:|:-----------------------:|------------------------------------------------|
|    GET     | Person Get By Parameter | http://your-server-ip:8080/api/v1/persons/test |

Параметри запиту відсутні.

**Приклад запиту** за допомогою утиліти **curl** виглядає наступним чином:

```
curl -X 'GET' \
  'http://your-server-ip:8080/api/v1/persons/test' \
  -H 'accept: */*'
```

**Тіло відповіді** у разі успішної перевірки працездатності сервісу (**HTTP Code=200**) виглядатиме наступним чином:

```
{
  "status": true,
  "descr": "request successful",
  "result": "Поточний час: 2025-03-27T22:17:14.962835818"
}
```

де:

| Рівень <br/> вкладеності | Назва <br/>параметру | Тип даних   | Значення параметру       | Обов’язковість |
|:------------------------:|----------------------|-------------|--------------------------|:--------------:|
|            1             | status               | Boolean     | Статус запиту            |      Так       |
|            1             | descr                | String      | Відповідь сервісу        |      Так       |
|            1             | result               | String      | Результат обробки запиту |      Так       |


**Тіло відповіді** у разі неуспішної перевірки працездатності сервісу (**HTTP Code=500 - Internal Server Error**) виглядатиме наступним чином:

```
{
    "status": "fail",
    "details": {
        "database": "disconnected",
        "error": "connect ECONNREFUSED 192.168.99.4:3306"
    }
}
```

де:

| Рівень <br/> вкладеності | Назва <br/>параметру | Тип даних | Значення параметру                                                                 | Обов’язковість |
|:------------------------:|----------------------|-----------|------------------------------------------------------------------------------------|:--------------:|
|            1             | 	status              | 	String    | Повідомлення про статус сервісу                                                                        |      	Так      |
|            1             | details                 |Array    | Масив даних                                                                        |      Так       |
|            2             | database                  | String     | Повідомлення про стан підключення до СКДБ                                              |      Так       |
|            2             | error                  | String     | Опис помилки                                              |      Так       |

 ##
Матеріали створено за підтримки проєкту міжнародної технічної допомоги «Підтримка ЄС цифрової трансформації України (DT4UA)».
